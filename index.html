<!doctype html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>matt</title>
	<meta name="description" content="mqtt Home Automation Dashboard">
	<meta name="author" content="Marco Koch">

	<meta name="viewport" content="width=device-width,initial-scale=1">

	<link rel="stylesheet" href="./style.css">

	<script src="jquery-1.7.1.min.js"></script>
	<script src="knockout.js"></script>
	
	<script>
	var device = function(topic)
	{
		var self = this;
		self.deviceTopic = topic;
		self.postURL = "./mqtt.php";
		
		self.sendToggle = function()
		{
			$.post(self.postURL, { t: self.deviceTopic});
		}
		
		self.sendOn = function()
		{
			$.post(self.postURL, { t: self.deviceTopic, p: "on" });
		}
		
		self.sendOff = function()
		{
			$.post(self.postURL, { t: self.deviceTopic, p: "off" });
		}
	}
	
	
	var mattViewModel = function()
	{
		led    = new device("byteli/light/1");
		heater = new device("vw/heater");
	};
	
	$(document).ready(function()
	{
		ko.applyBindings(new mattViewModel());
	})

	
	</script>
	
</head>
<body>

	<div>
		<p>byteli/light/1</p>
		<button class="myButton" data-bind='click: led.sendOn'>on</button>
		<button class="myButton" data-bind='click: led.sendOff'>off</button>
		<button class="myButton" data-bind='click: led.sendToggle'>toggle</button>
		<br/>
		<p>VW Büssli Heizöffeli (vw/heater)</p>
                <button class="myButton" data-bind='click: heater.sendOn'>on</button>
                <button class="myButton" data-bind='click: heater.sendOff'>off</button>
                <button class="myButton" data-bind='click: heater.sendToggle'>toggle</button>
	</div>

</body>
</html>
